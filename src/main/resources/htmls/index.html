<!doctype>
<html>
<head>
 <meta charset="UTF-8" />
<title>Display Page</title>
<script src="https://code.jquery.com/jquery-3.5.0.min.js"
	integrity="sha256-xNzN2a4ltkB44Mc/Jz3pT4iU1cmeR0FkXs4pru/JxaQ="
	crossorigin="anonymous"></script>
</head>
<body>
	<div style="text-align: center; width: 100%">
		<table
			style="width: 800px; cellpadding: 0; cellspacing: 0; border: 0px; border-spacing: 0px; border-collapse: separate;">
			<tr style="background: #cfcfcf">
				<th style='text-align: left; padding: 10px;' width="20%">Host:</th>
				<th style='text-align: left; padding: 10px;' width="20%"><input
					id="hostname" value="localhost"></th>
				<th style='text-align: left; padding: 10px;'>Port:</th>
				<th style='text-align: left; padding: 10px;'><input id="port"
					value="2525" size=1 maxlength=5 onkeypress=""
					style="text-align: right;"></th>
				<th style='text-align: center; padding: 10px;'>
					<button id="server_ss">sample text</button>
				</th>
			</tr>
		</table>
	</div>
	<table id="mail_details" style="width:800px;">
		<tr>
			<th>From</th>
			<th>To</th>
			<th>Subject</th>
			<th>Message</th>
			<th>Has Attac.</th>
			<th>Status</th>
		</tr>
	</table>
	<script>

$("#port").on("keypress", function (e) {
	if(e.keyCode < 48 || e.keyCode > 57)
	e.preventDefault();
})
function setButtonValue(status) {
	$("#server_ss").html(status==true?"Stop Mail Server":"Start Mail Server");
}

function updaetStatus() {
	$.ajax({
		url: "/status",
		data: {},
		success: function (jsonData) {
			console.log(jsonData);
			setButtonValue(jsonData.status);
		},
		error: function(errr) {
			z=errr;
		} 
	});
}
$("#server_ss").on("click", function (e) {
	var btnObj = this;
	$.ajax({
		url: "toggol",
		data: {
			hostname: $("#hostname").val(),
			port: $("#port").val()
		},
		success: function (jsonData) {
			if(jsonData.success == false) {
				return;
			}
			setButtonValue(jsonData.status);
		},
		error: function(errr) {
		} 
	});
});

loadList = function () {
	$.ajax({
		url: "/messages",
		data: {
		},
		success: function (jsonData) {
			var tab = document.getElementById("mail_details");
			for(var index in jsonData.data) {
				var row = tab.insertRow();
				//<th>From</th>
				//<th>To</th>
				//<th>Sub</th>
				//<th>Message</th>
				//<th>Has Attac.</th>
				//<th>Status</th>
				var cellFrom = row.insertCell();
				var cellTo = row.insertCell();
				var cellSub = row.insertCell();
				var cellMessage = row.insertCell();
				var cellHasAttach = row.insertCell();
				var cellStatus = row.insertCell();
				$(cellFrom).html(jsonData.data[index].from);
				$(cellTo).html(jsonData.data[index].to);
				$(cellSub).html(jsonData.data[index].subject);
				$(cellMessage).html(jsonData.data[index].mailBody);
				$(cellHasAttach).html(jsonData.data[index].attachement);
				$(cellStatus).html(jsonData.data[index].readByTester);
			}
		},
		error: function (err) {
			rerr = err;
		}
	});
}
updaetStatus();
</script>

</body>
</html>